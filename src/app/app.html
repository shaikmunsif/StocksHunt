<div
  class="app-shell min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-gray-900 dark:via-slate-900 dark:to-gray-900 transition-colors duration-500"
>
  @if (authService.isAuthenticated()) {
  <app-sidebar></app-sidebar>
  }

  <!-- Global Theme Toggle (visible for all users) -->
  <div class="global-theme-toggle">
    <app-theme-toggle></app-theme-toggle>
  </div>

  <div
    class="main-content"
    [class.authenticated]="authService.isAuthenticated()"
    [class.sidebar-collapsed]="layoutService.isSidebarCollapsed()"
  >
    <main
      class="w-full px-4 sm:px-6 lg:px-8 py-8"
      [class.max-w-7xl]="authService.isAuthenticated()"
      [class.mx-auto]="authService.isAuthenticated()"
      [class.mobile-padding-top]="authService.isAuthenticated()"
    >
      <!-- Shimmer loader for lazy-loaded components -->
      @if (isLoadingRoute) {
        <app-shimmer-loader type="full-page" [rows]="8"></app-shimmer-loader>
      } @else {
        <router-outlet></router-outlet>
      }
    </main>

    @if (authService.isAuthenticated()) {
    <footer
      class="bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-auto transition-colors duration-300"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <p
          class="text-center text-gray-600 dark:text-gray-400 text-sm transition-colors duration-300"
        >
          {{ currentYear }} StockGainers. Built with Angular & Tailwind CSS.
        </p>
      </div>
    </footer>
    }
  </div>
</div>

<style>
  .app-shell {
    display: flex;
    min-height: 100vh;
  }

  .main-content {
    flex: 1;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    padding-left: 0;
  }

  .main-content.authenticated {
    margin-left: 260px;
  }

  .main-content.authenticated.sidebar-collapsed {
    margin-left: 70px;
  }

  /* Mobile: Add padding for fixed header */
  @media (max-width: 1023px) {
    .main-content.authenticated {
      margin-left: 0;
      padding-top: 60px;
    }

    .main-content.authenticated.sidebar-collapsed {
      margin-left: 0;
    }

    .mobile-padding-top {
      padding-top: 0 !important;
    }
  }

  .global-theme-toggle {
    position: fixed;
    bottom: 24px;
    right: 24px;
    z-index: 40;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .global-theme-toggle:hover {
    transform: translateY(-2px);
  }

  /* Mobile: Reposition theme toggle to avoid footer overlap */
  @media (max-width: 1023px) {
    .global-theme-toggle {
      bottom: 80px;
      right: 16px;
      z-index: 30;
    }
  }

  @media (max-width: 640px) {
    .global-theme-toggle {
      bottom: 70px;
      right: 12px;
    }
  }
</style>
